# Template file for 'r8125-dkms'
pkgname=r8125-dkms
version=9.004.01
revision=1
_gitrev=e174fe9d2ccf5c64fc79e980683fd2bae8413c35
archs=noarch
wrksrc="r8125-${version}"
depends="dkms"
short_desc="Realtek RTL8125 driver (DKMS)"
maintainer="Anton Afanasyev <anton@doubleasoftware.com>"
license="GPL-2.0-only"
homepage="https://www.realtek.com/"
distfiles="https://github.com/ibmibmibm/r8125/archive/${_gitrev}.tar.gz"
checksum=10d96d19cbd6c2a251445de516788c4afb485c57bb9e8d4c96ec14fa56e2c324
dkms_modules="r8125 ${version}"

do_install() {
	vmkdir /usr/src/r8125-${version}
	vcopy "src/*" usr/src/r8125-${version}
	vinstall ${FILESDIR}/dkms.conf 644 usr/src/r8125-${version}
	sed -i -e "s/@VERSION@/${version}-${revision}/" ${PKGDESTDIR}/usr/src/r8125-${version}/dkms.conf

	# modules-load.d(5) file.
	vmkdir usr/lib/modules-load.d
	echo "r8125" > ${DESTDIR}/usr/lib/modules-load.d/r8125.conf
	chmod 644 ${DESTDIR}/usr/lib/modules-load.d/r8125.conf
}
